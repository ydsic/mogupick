name: Discord Notification on Push

on:
  push:
    branches: [main]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Set developer name
        id: dev-name
        run: |
          if [ "${{ github.actor }}" = "ydsic" ]; then
            echo "name=ì´ì˜ˆë„" >> $GITHUB_OUTPUT
          elif [ "${{ github.actor }}" = "eillen-yang" ]; then
            echo "name=ì–‘ì•„ë¦„" >> $GITHUB_OUTPUT
          else
            echo "name=${{ github.actor }}" >> $GITHUB_OUTPUT
          fi

          timestamp=$(date -d "${{ github.event.head_commit.timestamp }}" +"%mì›” %dì¼ %H:%M")
          echo "formatted-time=$timestamp" >> $GITHUB_OUTPUT

      - name: Send Discord notification
        uses: Ilshidur/action-discord@master
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        with:
          args: |
            ## ğŸ‰ ìƒˆë¡œìš´ ì½”ë“œê°€ ë°°í¬ë˜ì—ˆì–´ìš”!

            **ğŸ“‹ í”„ë¡œì íŠ¸:** `${{ github.repository }}`
            **ğŸ‘¤ ê°œë°œì:** `${{ steps.dev-name.outputs.name }}`
            **â° ì‹œê°„:** `${{ steps.dev-name.outputs.formatted-time }}`

            **ğŸ’­ ì»¤ë°‹ ë©”ì‹œì§€:**
            ```
            ${{ github.event.head_commit.message }}
            ```

            **ğŸ”— ë§í¬:** [ì»¤ë°‹ ë³´ê¸°](${{ github.event.head_commit.url }})
